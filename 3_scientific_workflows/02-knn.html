<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" />

    <meta name="generator" content="sphinx-4.5.0, furo 2022.06.04.1"/>
        <title>KNN Land Classification with Dask [40 hours] - GEOAnalytics Canada</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">GEOAnalytics Canada</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/geoanalytics-icon.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">GEOAnalytics Canada</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Welcome</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_getting_started/index.html">Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_getting_started/02-geospatial-python.html"><strong>Working with Earth Observation data in Python</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_getting_started/03-jupyter-notebooks.html"><strong>Jupyter Notebooks</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_getting_started/04-authentication.html"><strong>Authentication</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_getting_started/05-desktop-vm.html"><strong>Desktop VM’s</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_getting_started/06-file-browser.html"><strong>File Browser</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_getting_started/07-stac.html"><strong>SpatioTemporal Asset Catalog (STAC)</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_getting_started/08-gitlab.html"><strong>GitLab</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_getting_started/09-pipelines.html"><strong>Pipelines</strong></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2_real_world_examples/index.html">Real World Examples</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2_real_world_examples/01-accessing-data.html"><strong>Accessing and Downloading Data</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../2_real_world_examples/02-ndvi-with-dask.html"><strong>NDVI With Dask</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../2_real_world_examples/03-ndsi-with-dask.html">1. Initialize your Dask Gateway Clusters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2_real_world_examples/03-ndsi-with-dask.html#2.-Getting-the-MODIS-Data">2. Getting the MODIS Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2_real_world_examples/03-ndsi-with-dask.html#3.-Calculating-the-NDSI">3. Calculating the NDSI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2_real_world_examples/03-ndsi-with-dask.html#4.-Visualizing-the-Results">4. Visualizing the Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2_real_world_examples/04-ndwi-with-dask.html"><strong>NDWI With Dask</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../2_real_world_examples/05-change-detection.html"><strong>Change Detection</strong></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="index.html">Scientific Workflows</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="01-flnro-esque-pipeline.html"><strong>Daily NDSI Average Pipeline</strong></a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="KNN-Land-Classification-with-Dask-[40-hours]">
<h1>KNN Land Classification with Dask [40 hours]<a class="headerlink" href="#KNN-Land-Classification-with-Dask-[40-hours]" title="Permalink to this headline">#</a></h1>
<p>A common machine learning approach to geospatial data is classifying land – this can be roughly estimated be using a K-Nearest Neighbours (KNN) model.</p>
<p>To help you with that KNN notebook, I recently built a K-Means-Dask notebook for GCT. KNN is a supervised classification, whereas K-Means is unsupervised - so, if you did KNN, you’d have to pick N-points and classify them manually before having the KNN predict over an entire raster. When we envisioned this, I was thinking K-Means and called it the wrong thing, sorry. We want a K-Means model.</p>
<p>Use the K-Means notebook below to help you along but you need to use data that <em>isn’t</em> part of a project (that drone data is 30cm/px and an interesting case). It would be pretty interesting to do a large area, say, four (square) S2 L2A tiles (10m) which you’d have to create a clean composite (say, May 1st to September 31st queried with STAC), mosaic them together, and have the K-Means model cluster. Of course, start with a single tile and scaling up is easy for you now ;)</p>
<p>The important factors are leveraging different indices for clustering (like NDVI, NDWI, and whatever else makes sense to include) to help make more accurate cluster predictions and also how we interpret the cluster output. Usually, we’d use those classifications and, if accurate enough, would feed clips into a Random Forest model to make more accurate predictions (this is what Barry is doing with GCT post-my-part). That’s out of scope for this but good to know what it’d be used for.</p>
<p>Cooking shows be like: “Here’s one we made earlier” <a class="reference external" href="https://git.hatfieldgroup.net/Hatfield_Geomatics/gct10314/-/blob/dev/KMeans-drone_investigation.ipynb">https://git.hatfieldgroup.net/Hatfield_Geomatics/gct10314/-/blob/dev/KMeans-drone_investigation.ipynb</a></p>
<p>To summarize: - edit the notebook to use S2 L2A (10m) - create a seasonal composite (May to Sept) of S2 tile - create indices (NDVI, NDWI, etc…) - convert data array into data frame (use the existing reshape and insert functions) - process through K-Means - visualize output - scale to more tiles to simulate large AOI’s</p>
<p>Of course, any questions, let me know, and we can definitely have a meeting after the holiday to go over the notebook, too.</p>
<p>Jason - do you have any particular AOI you’d want to see?</p>
<section id="K-Means-Land-Classification-with-Dask-(WIP!!)">
<h2>K-Means Land Classification with Dask (WIP!!)<a class="headerlink" href="#K-Means-Land-Classification-with-Dask-(WIP!!)" title="Permalink to this headline">#</a></h2>
</section>
</section>
<section id="1.-Initialize-Dask-Cluster">
<h1>1. Initialize Dask Cluster<a class="headerlink" href="#1.-Initialize-Dask-Cluster" title="Permalink to this headline">#</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import dask
import dask.distributed
from dask_gateway import Gateway
from dask.distributed import wait, progress
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/srv/conda/envs/notebook/lib/python3.9/site-packages/dask_gateway/client.py:21: FutureWarning: format_bytes is deprecated and will be removed in a future release. Please use dask.utils.format_bytes instead.
  from distributed.utils import LoopRunner, format_bytes
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>gateway = Gateway()
gateway.list_clusters()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>clusters = gateway.list_clusters()
cluster = gateway.connect(clusters[0].name, shutdown_on_close=True)
client = cluster.get_client()
cluster
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "57fff0a041904cae8b490b5ef0664993", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>gateway = Gateway()
#cluster = gateway.new_cluster(options)
#cluster = gateway.new_cluster(image=&#39;pangeo/pangeo-notebook:2021.07.17&#39;)
cluster = gateway.new_cluster(image=&#39;pangeo/pangeo-notebook:2021.11.09&#39;)
# Scale the cluster
workers = 120
cluster.scale(workers)
# Assign client to this cluster so Dask knows to use it for computations
client = cluster.get_client()
cluster
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e48733cde0534977b5f43c990430e718", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cluster.scale(120)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cluster
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6235816964454eed980a19345c79cfcc", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="Query-using-the-SentinelSat-API">
<h1>Query using the SentinelSat API<a class="headerlink" href="#Query-using-the-SentinelSat-API" title="Permalink to this headline">#</a></h1>
<p>To get the data in our Area of Interest (AOI) within a specified time range, we will use the SentinelSat API (Temporarily until we have our Hatfield STAC fully-functional, since the Sentinel 2 Data is not added yet).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>!pip install sentinelsat
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Collecting sentinelsat
  Downloading sentinelsat-1.1.0-py3-none-any.whl (48 kB)
     |████████████████████████████████| 48 kB 3.6 MB/s eta 0:00:011
Requirement already satisfied: requests in /srv/conda/envs/notebook/lib/python3.9/site-packages (from sentinelsat) (2.26.0)
Requirement already satisfied: click in /srv/conda/envs/notebook/lib/python3.9/site-packages (from sentinelsat) (7.1.2)
Collecting html2text
  Downloading html2text-2020.1.16-py3-none-any.whl (32 kB)
Requirement already satisfied: tqdm&gt;=4.27 in /srv/conda/envs/notebook/lib/python3.9/site-packages (from sentinelsat) (4.62.3)
Collecting geomet
  Downloading geomet-0.3.0-py3-none-any.whl (28 kB)
Collecting geojson&gt;=2
  Downloading geojson-2.5.0-py2.py3-none-any.whl (14 kB)
Requirement already satisfied: six in /srv/conda/envs/notebook/lib/python3.9/site-packages (from geomet-&gt;sentinelsat) (1.16.0)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /srv/conda/envs/notebook/lib/python3.9/site-packages (from requests-&gt;sentinelsat) (1.26.7)
Requirement already satisfied: charset-normalizer~=2.0.0 in /srv/conda/envs/notebook/lib/python3.9/site-packages (from requests-&gt;sentinelsat) (2.0.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /srv/conda/envs/notebook/lib/python3.9/site-packages (from requests-&gt;sentinelsat) (2021.10.8)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /srv/conda/envs/notebook/lib/python3.9/site-packages (from requests-&gt;sentinelsat) (3.1)
Installing collected packages: html2text, geomet, geojson, sentinelsat
Successfully installed geojson-2.5.0 geomet-0.3.0 html2text-2020.1.16 sentinelsat-1.1.0
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Import all the necessary modules

import yaml
import os
import glob
import rasterio
import fiona
import shapely.geometry
import datetime
import scipy
import gcsfs
import json

import xarray as xr
import geopandas as gpd
import pandas as pd
import rioxarray as rxr
import dask.array as da
import numpy as np
import matplotlib.pyplot as plt

from collections import defaultdict
from rioxarray.merge import merge_arrays
from shapely.geometry import mapping,Polygon
from sentinelsat import SentinelAPI, read_geojson, geojson_to_wkt
from matplotlib.colors import ListedColormap
from datetime import date
from datetime import datetime
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># Load the yaml file containing the authentication to your SentinelSat account
envvars = open(&#39;data/SS_config.yml&#39; ,&#39;r&#39;)
secrets = yaml.load(envvars, Loader=yaml.FullLoader)
envvars.close()
</pre></div>
</div>
</div>
</section>
<section id="2.-Functions">
<h1>2. Functions<a class="headerlink" href="#2.-Functions" title="Permalink to this headline">#</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>bounding_box = (-120.5804,58.0139,-119.6521,58.3556)
#bounding_box = (-122.442627,58.447733,-120.992432,59.285526)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>polygon = shapely.geometry.box(*bounding_box, ccw=True)
polygon
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/3_scientific_workflows_02-knn_16_0.svg" src="../_images/3_scientific_workflows_02-knn_16_0.svg" /></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fp = &#39;/home/jovyan/geoanalytics_user_shared_data/CSA10332/caribou-aoi/GCBP_CARIB_polygon.shp&#39;
gdf = gpd.read_file(fp)
gdf[gdf[&#39;CAR_TAG&#39;] == &#39;Snake-Sahtaneh&#39;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CAR_POP_ID</th>
      <th>CAR_TAG</th>
      <th>HERD_NO</th>
      <th>HERD_STAT</th>
      <th>HERD_NAME</th>
      <th>ECOTYPE</th>
      <th>RISK_STAT</th>
      <th>STMTDCRBPP</th>
      <th>YR_F_LST_Y</th>
      <th>FEAT_CODE</th>
      <th>OBJECTID</th>
      <th>AREA_SQM</th>
      <th>FEAT_LEN</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>21</th>
      <td>1909</td>
      <td>Snake-Sahtaneh</td>
      <td>64</td>
      <td>Herd</td>
      <td>Snake-Sahtaneh</td>
      <td>Boreal</td>
      <td>Blue/Threatened</td>
      <td>321  (minimum count)</td>
      <td>2013</td>
      <td>FF84630000</td>
      <td>141.0</td>
      <td>1.200705e+10</td>
      <td>741286.9932</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def query_sentinel(username, password, footprint, start_date, end_date, max_cloud_cover):
    # Validate credentials for API access
    api = SentinelAPI(username, password, &#39;https://scihub.copernicus.eu/dhus&#39;)
    products = api.query(footprint,
                         date=(start_date, end_date),
                         platformname=&#39;Sentinel-2&#39;,
                         producttype=&#39;S2MSI1C&#39;,
                         cloudcoverpercentage=(0, max_cloud_cover))

    # Convert to Pandas DataFrame
    products_df = api.to_dataframe(products)
    # Remove rows with NaN for Tile ID and sort by ascending cloud cover
    df = products_df[products_df[&#39;tileid&#39;].notna()].sort_values([&#39;beginposition&#39;,&#39;cloudcoverpercentage&#39;], ascending=[True,True])

    df = df.drop_duplicates(subset=[&#39;beginposition&#39;, &#39;tileid&#39;], keep=&#39;first&#39;)


    # Only return dataframe with specific columns
    final_df = df[[&#39;title&#39;, &#39;beginposition&#39;, &#39;relativeorbitnumber&#39;, &#39;cloudcoverpercentage&#39;, &#39;tileid&#39;]].reset_index(drop=True)

    return final_df
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>start_date = &#39;20210501&#39;
end_date = &#39;20210730&#39;
query_df = query_sentinel(secrets[&#39;SENTINELSAT_USER&#39;], secrets[&#39;SENTINELSAT_PASS&#39;], polygon, start_date, end_date, 30)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>query_df
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>beginposition</th>
      <th>relativeorbitnumber</th>
      <th>cloudcoverpercentage</th>
      <th>tileid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S2A_MSIL1C_20210511T192911_N0300_R142_T11VLE_2...</td>
      <td>2021-05-11 19:29:11.024</td>
      <td>142</td>
      <td>11.4487</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>1</th>
      <td>S2A_MSIL1C_20210521T192911_N0300_R142_T11VLE_2...</td>
      <td>2021-05-21 19:29:11.024</td>
      <td>142</td>
      <td>26.3831</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S2B_MSIL1C_20210523T191909_N0300_R099_T10VFK_2...</td>
      <td>2021-05-23 19:19:09.024</td>
      <td>99</td>
      <td>21.5361</td>
      <td>10VFK</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S2A_MSIL1C_20210531T192911_N0300_R142_T11VLE_2...</td>
      <td>2021-05-31 19:29:11.024</td>
      <td>142</td>
      <td>0.0000</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S2B_MSIL1C_20210605T192909_N0300_R142_T11VLE_2...</td>
      <td>2021-06-05 19:29:09.024</td>
      <td>142</td>
      <td>21.0096</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>5</th>
      <td>S2A_MSIL1C_20210610T192911_N0300_R142_T11VLE_2...</td>
      <td>2021-06-10 19:29:11.024</td>
      <td>142</td>
      <td>19.3655</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>6</th>
      <td>S2B_MSIL1C_20210619T190919_N0300_R056_T11VLE_2...</td>
      <td>2021-06-19 19:09:19.024</td>
      <td>56</td>
      <td>1.1197</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>7</th>
      <td>S2B_MSIL1C_20210619T190919_N0300_R056_T10VFK_2...</td>
      <td>2021-06-19 19:09:19.024</td>
      <td>56</td>
      <td>1.5295</td>
      <td>10VFK</td>
    </tr>
    <tr>
      <th>8</th>
      <td>S2A_MSIL1C_20210620T192911_N0300_R142_T10VFK_2...</td>
      <td>2021-06-20 19:29:11.024</td>
      <td>142</td>
      <td>10.9192</td>
      <td>10VFK</td>
    </tr>
    <tr>
      <th>9</th>
      <td>S2B_MSIL1C_20210625T192909_N0300_R142_T11VLE_2...</td>
      <td>2021-06-25 19:29:09.024</td>
      <td>142</td>
      <td>0.0000</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>10</th>
      <td>S2B_MSIL1C_20210625T192909_N0300_R142_T10VFK_2...</td>
      <td>2021-06-25 19:29:09.024</td>
      <td>142</td>
      <td>0.0000</td>
      <td>10VFK</td>
    </tr>
    <tr>
      <th>11</th>
      <td>S2A_MSIL1C_20210627T191911_N0300_R099_T11VLE_2...</td>
      <td>2021-06-27 19:19:11.024</td>
      <td>99</td>
      <td>0.0000</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>12</th>
      <td>S2A_MSIL1C_20210627T191911_N0300_R099_T10VFK_2...</td>
      <td>2021-06-27 19:19:11.024</td>
      <td>99</td>
      <td>0.0000</td>
      <td>10VFK</td>
    </tr>
    <tr>
      <th>13</th>
      <td>S2B_MSIL1C_20210629T190919_N0300_R056_T10VFK_2...</td>
      <td>2021-06-29 19:09:19.024</td>
      <td>56</td>
      <td>0.0000</td>
      <td>10VFK</td>
    </tr>
    <tr>
      <th>14</th>
      <td>S2B_MSIL1C_20210629T190919_N0300_R056_T11VLE_2...</td>
      <td>2021-06-29 19:09:19.024</td>
      <td>56</td>
      <td>0.0067</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>15</th>
      <td>S2A_MSIL1C_20210630T192911_N0301_R142_T10VFK_2...</td>
      <td>2021-06-30 19:29:11.024</td>
      <td>142</td>
      <td>0.0000</td>
      <td>10VFK</td>
    </tr>
    <tr>
      <th>16</th>
      <td>S2A_MSIL1C_20210630T192911_N0301_R142_T11VLE_2...</td>
      <td>2021-06-30 19:29:11.024</td>
      <td>142</td>
      <td>0.0000</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>17</th>
      <td>S2A_MSIL1C_20210704T190921_N0301_R056_T11VLE_2...</td>
      <td>2021-07-04 19:09:21.024</td>
      <td>56</td>
      <td>20.7005</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>18</th>
      <td>S2B_MSIL1C_20210705T192909_N0301_R142_T10VFK_2...</td>
      <td>2021-07-05 19:29:09.024</td>
      <td>142</td>
      <td>0.0000</td>
      <td>10VFK</td>
    </tr>
    <tr>
      <th>19</th>
      <td>S2B_MSIL1C_20210705T192909_N0301_R142_T11VLE_2...</td>
      <td>2021-07-05 19:29:09.024</td>
      <td>142</td>
      <td>0.0000</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>20</th>
      <td>S2B_MSIL1C_20210709T190919_N0301_R056_T10VFK_2...</td>
      <td>2021-07-09 19:09:19.024</td>
      <td>56</td>
      <td>2.8214</td>
      <td>10VFK</td>
    </tr>
    <tr>
      <th>21</th>
      <td>S2B_MSIL1C_20210709T190919_N0301_R056_T11VLE_2...</td>
      <td>2021-07-09 19:09:19.024</td>
      <td>56</td>
      <td>23.8603</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>22</th>
      <td>S2B_MSIL1C_20210715T192909_N0301_R142_T10VFK_2...</td>
      <td>2021-07-15 19:29:09.024</td>
      <td>142</td>
      <td>23.7284</td>
      <td>10VFK</td>
    </tr>
    <tr>
      <th>23</th>
      <td>S2A_MSIL1C_20210724T190921_N0301_R056_T10VFK_2...</td>
      <td>2021-07-24 19:09:21.024</td>
      <td>56</td>
      <td>23.4152</td>
      <td>10VFK</td>
    </tr>
    <tr>
      <th>24</th>
      <td>S2A_MSIL1C_20210724T190921_N0301_R056_T11VLE_2...</td>
      <td>2021-07-24 19:09:21.024</td>
      <td>56</td>
      <td>23.6013</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>25</th>
      <td>S2B_MSIL1C_20210725T192909_N0301_R142_T10VFK_2...</td>
      <td>2021-07-25 19:29:09.024</td>
      <td>142</td>
      <td>21.5652</td>
      <td>10VFK</td>
    </tr>
    <tr>
      <th>26</th>
      <td>S2B_MSIL1C_20210725T192909_N0301_R142_T11VLE_2...</td>
      <td>2021-07-25 19:29:09.024</td>
      <td>142</td>
      <td>28.4198</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>27</th>
      <td>S2B_MSIL1C_20210729T190919_N0301_R056_T11VLE_2...</td>
      <td>2021-07-29 19:09:19.024</td>
      <td>56</td>
      <td>0.4682</td>
      <td>11VLE</td>
    </tr>
    <tr>
      <th>28</th>
      <td>S2B_MSIL1C_20210729T190919_N0301_R056_T10VFK_2...</td>
      <td>2021-07-29 19:09:19.024</td>
      <td>56</td>
      <td>0.8539</td>
      <td>10VFK</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>query_df[&#39;tileid&#39;].unique()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;11VLE&#39;, &#39;10VFK&#39;], dtype=object)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def get_sentinel_data(input_df, bands_wanted):
    # 1. Create dataframe to store the path to the granules we want
    df = pd.DataFrame()

    # 2. Iterate through the queried dataframe and store the file paths to the desired bands in a new dataframe.
    for i,row in input_df.iterrows():
        # if row[&#39;relativeorbitnumber&#39;] != 50:
        #     continue
        # Variables representing subdirectories to obtain the filepaths
        tile = row[&#39;tileid&#39;]
        title = row[&#39;title&#39;]
        img_title = row[&#39;title&#39;][11:19]
        utm = tile[0:2]
        latitude = tile[2]
        direction = tile[3:5]
        dir_path = f&#39;/home/jovyan/gcp-public-data-sentinel-2/L2/tiles/{utm}/{latitude}/{direction}/*{img_title}*/GRANULE/*&#39;
        if not glob.glob(dir_path): # check if folder exists
            continue
        # Get SCL Mask
        scl_path = glob.glob(f&#39;/home/jovyan/gcp-public-data-sentinel-2/L2/tiles/{utm}/{latitude}/{direction}/*{img_title}*/GRANULE/*/IMG_DATA/R20m/*SCL*.jp2&#39;)
        if not scl_path: # check if SCL exists
            continue
        scl_path[0] = scl_path[0].replace(&#39;/home/jovyan/&#39;,&#39;https://storage.googleapis.com/&#39;)

        row_dict = {&#39;date&#39;: row[&#39;beginposition&#39;],
                    &#39;cloud_cover&#39; : row[&#39;cloudcoverpercentage&#39;],
                    &#39;tile_ID&#39;: row[&#39;tileid&#39;],
                    &#39;SCL&#39;: scl_path[0]}

        #Iterate through the list of input bands and store the filepath in a dictionary
        for band in bands_wanted:
            filepath = glob.glob(f&#39;{dir_path}/IMG_DATA/R10m/*{band}*.jp2&#39;)
            filepath[0] = filepath[0].replace(&#39;/home/jovyan/&#39;,&#39;https://storage.googleapis.com/&#39;)
            row_dict.update({band:filepath[0]})
        # Add the dictionary as a dataframe row
        df = df.append(row_dict,ignore_index=True)

    return df
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>bands_wanted = [&#39;B02&#39;, &#39;B03&#39;, &#39;B04&#39;, &#39;B08&#39;]
df = get_sentinel_data(query_df, bands_wanted)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>cloud_cover</th>
      <th>tile_ID</th>
      <th>SCL</th>
      <th>B02</th>
      <th>B03</th>
      <th>B04</th>
      <th>B08</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-05-11 19:29:11.024</td>
      <td>11.4487</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-05-21 19:29:11.024</td>
      <td>26.3831</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-05-23 19:19:09.024</td>
      <td>21.5361</td>
      <td>10VFK</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-05-31 19:29:11.024</td>
      <td>0.0000</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-06-05 19:29:09.024</td>
      <td>21.0096</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2021-06-10 19:29:11.024</td>
      <td>19.3655</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2021-06-19 19:09:19.024</td>
      <td>1.1197</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2021-06-19 19:09:19.024</td>
      <td>1.5295</td>
      <td>10VFK</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2021-06-20 19:29:11.024</td>
      <td>10.9192</td>
      <td>10VFK</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2021-06-25 19:29:09.024</td>
      <td>0.0000</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2021-06-25 19:29:09.024</td>
      <td>0.0000</td>
      <td>10VFK</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2021-06-27 19:19:11.024</td>
      <td>0.0000</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2021-06-27 19:19:11.024</td>
      <td>0.0000</td>
      <td>10VFK</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2021-06-29 19:09:19.024</td>
      <td>0.0000</td>
      <td>10VFK</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2021-06-29 19:09:19.024</td>
      <td>0.0067</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2021-06-30 19:29:11.024</td>
      <td>0.0000</td>
      <td>10VFK</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2021-06-30 19:29:11.024</td>
      <td>0.0000</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2021-07-04 19:09:21.024</td>
      <td>20.7005</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2021-07-05 19:29:09.024</td>
      <td>0.0000</td>
      <td>10VFK</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2021-07-05 19:29:09.024</td>
      <td>0.0000</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2021-07-09 19:09:19.024</td>
      <td>2.8214</td>
      <td>10VFK</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2021-07-09 19:09:19.024</td>
      <td>23.8603</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2021-07-15 19:29:09.024</td>
      <td>23.7284</td>
      <td>10VFK</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2021-07-24 19:09:21.024</td>
      <td>23.4152</td>
      <td>10VFK</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2021-07-24 19:09:21.024</td>
      <td>23.6013</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2021-07-25 19:29:09.024</td>
      <td>21.5652</td>
      <td>10VFK</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2021-07-25 19:29:09.024</td>
      <td>28.4198</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2021-07-29 19:09:19.024</td>
      <td>0.4682</td>
      <td>11VLE</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2021-07-29 19:09:19.024</td>
      <td>0.8539</td>
      <td>10VFK</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
      <td>https://storage.googleapis.com/gcp-public-data...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="2.-Loading,-Masking,-and-Creating-Mosaics">
<h1>2. Loading, Masking, and Creating Mosaics<a class="headerlink" href="#2.-Loading,-Masking,-and-Creating-Mosaics" title="Permalink to this headline">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">get_band_images()</span></code> function loads the band granule and masks out the cloud pixels.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>@dask.delayed()
def open_ras(pth,bandname=None, chunks=None):
    img = xr.open_rasterio(pth, chunks=chunks)
    img.attrs[&#39;nodatavals&#39;] = (0,)
    img[&#39;band&#39;] = [bandname]
    return img
<br/><br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>@dask.delayed()
def mask_ras(b, scl):
    masked = xr.where((scl.data == 0)   # no data
                          | (scl.data == 1)   # saturated
                          | (scl.data == 3)   # cloud shadows
                          | (scl.data == 8)  # cloud medium probability
                          | (scl.data == 9)  # cloud high probability
                          | (scl.data == 10) # thin cirrus
                          , np.nan, b.data)
    # snow mask
   # snow_masked = xr.where((scl.data == 11), -1111, masked)
    b.data = masked
    return b
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[147]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>@dask.delayed
def merge_band(bandN):
    merged = merge_arrays(bandN)
    merged = merged.astype(np.float32)
    return merged.chunk(&#39;auto&#39;)
    # return merge_arrays(bandN).chunk(&#39;auto&#39;)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>@dask.delayed
def projecting(array, change_res=False):
    import rasterio
    import rioxarray
    import xarray
    if change_res == True:
        reproj = array.rio.reproject(&#39;EPSG:4326&#39;, resolution=(10,10))
    else:
        reproj = array.rio.reproject(&#39;EPSG:4326&#39;)
    return reproj
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>@dask.delayed
def clipping(array, poly):
    import rasterio
    import rioxarray
    import xarray
    #bbox = np.array(poly.bounds)[0]
    bbox = np.array(poly.bounds)
    print(array.shape)
    return array.rio.clip_box(*bbox)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[137]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>@dask.delayed()
def clean_array(arr):
    arr.data = da.where((arr.data == -9999), np.nan, arr.data)
    return arr
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>@dask.delayed
def concat_list(lst, dimension):
    return xr.concat(lst, dim=dimension)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>@dask.delayed
def date_layer(ref_band, date):
    int_date = time_to_int(date)

    time_band = ref_band.copy()
    replace = np.zeros(ref_band.data.shape)
    replace[(replace == 0)] = int_date
    replace = np.where(np.isnan(ref_band.data),np.nan,replace)
    time_band.data = replace
    time_band[&#39;band&#39;] = [&#39;date&#39;]
    return time_band
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def time_to_int(vals):
    timestamp = vals.astype(object)
    date = datetime.fromtimestamp(timestamp / 1e9)
    year = date.year
    month = date.month
    day = date.day
    if month &lt; 10:
        month = &#39;0&#39; + str(month)
    else:
        month = str(month)
    if day &lt; 10:
        day = &#39;0&#39; + str(day)
    else:
        day = str(day)
    return int(str(year) + month + day)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[120]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def normalize(array):
    norm = (array - array.min()) / (array.max() - array.min())
    return norm


def color_composite(ds, col1, col2, col3, scale):
    # Stack the bands 4,3,2 for a true color composite
    np_color = da.dstack((normalize(ds.sel(band=col1)),
                         normalize(ds.sel(band=col2)),
                         normalize(ds.sel(band=col3))))*scale

    col_comp_ds = ds.sel(band=[col1,col2,col3]).transpose(&#39;y&#39;,&#39;x&#39;,&#39;band&#39;)
    col_comp_ds.data = np_color

    return col_comp_ds
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[155]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def create_mosaics(wanted_bands, df):

    tile_count = len(df.tile_ID.unique())
    dates = df.date.unique()
    total = []
    date_dict = {}
    total_SCL = []
    for date in dates:
        each_date_list = []
        # Create a sub-dataframe with only the same date rows
        df_date = df[(df.date == date)]
        if tile_count != len(df_date): # If the date doesnt have all the tiles needed to create a mosaic, skip date
            dates = dates[dates != date]
            continue

        bands = defaultdict(list)
        # 1. Open the raster bands
       #  SCL_list = [open_ras(pth, &#39;SCL&#39;, chunks={&#39;band&#39;: 1, &#39;y&#39;:&#39;auto&#39;, &#39;x&#39;:&#39;auto&#39;}) for pth in df_date[&#39;SCL&#39;].values]
       #  projected_scl = [projecting(scls, True) for scls in SCL_list]
       #  merged_SCL = merge_band(projected_scl)
       # # clipped_SCL = clipping(merged_SCL, polygon)
       #  # Clean up and remove the nan values from the array
       #  cleaned_scl = clean_array(merged_SCL)

        for b in wanted_bands:
            bands[b] = [open_ras(pth, b, &#39;auto&#39;) for pth in df_date[b].values]
            bands[b] = [projecting(bnd) for bnd in bands[b]]
            bands[b] = merge_band(bands[b])
           # bands[b] = clipping(bands[b], polygon)
            bands[b] = clean_array(bands[b])
       #     bands[b] = mask_ras(bands[b], cleaned_scl)
            each_date_list.append(bands[b])

        # date_band = date_layer(bands[b], date)
        # each_date_list.append(date_band)

         # concatenate all the bands together
        concat_bands = concat_list(each_date_list, &#39;band&#39;)
        total.append(concat_bands)
        #break

    return total, dates
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[156]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>client.restart()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[156]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;"> </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px;">Client</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">Client-4d8bc641-6a80-11ec-8167-f3a89343e5d6</p>
        <table style="width: 100%; text-align: left;">

        <tr>

            <td style="text-align: left;"><strong>Connection method:</strong> Cluster object</td>
            <td style="text-align: left;"><strong>Cluster type:</strong> dask_gateway.GatewayCluster</td>

        </tr>


            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard: </strong> <a href="http://traefik-dask-gateway.geoanalytics.ca/services/dask-gateway/clusters/pangeo.b1a354b2a0fe4160a98f353a66e28a82/status" target="_blank">http://traefik-dask-gateway.geoanalytics.ca/services/dask-gateway/clusters/pangeo.b1a354b2a0fe4160a98f353a66e28a82/status</a>
                </td>
                <td style="text-align: left;"></td>
            </tr>


        </table>


            <details>
            <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Cluster Info</h3></summary>
            <div style='background-color: #f2f2f2; display: inline-block; padding: 10px; border: 1px solid #999999;'>
  <h3>GatewayCluster</h3>
  <ul>
    <li><b>Name: </b>pangeo.b1a354b2a0fe4160a98f353a66e28a82
    <li><b>Dashboard: </b><a href='http://traefik-dask-gateway.geoanalytics.ca/services/dask-gateway/clusters/pangeo.b1a354b2a0fe4160a98f353a66e28a82/status' target='_blank'>http://traefik-dask-gateway.geoanalytics.ca/services/dask-gateway/clusters/pangeo.b1a354b2a0fe4160a98f353a66e28a82/status</a>
  </ul>
</div>

            </details>


    </div>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[157]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>mosaic_arrays, dates = create_mosaics(bands_wanted, df)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[158]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>dates
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[158]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;2021-06-19T19:09:19.024000000&#39;, &#39;2021-06-25T19:29:09.024000000&#39;,
       &#39;2021-06-27T19:19:11.024000000&#39;, &#39;2021-06-29T19:09:19.024000000&#39;,
       &#39;2021-06-30T19:29:11.024000000&#39;, &#39;2021-07-05T19:29:09.024000000&#39;,
       &#39;2021-07-09T19:09:19.024000000&#39;, &#39;2021-07-24T19:09:21.024000000&#39;,
       &#39;2021-07-25T19:29:09.024000000&#39;, &#39;2021-07-29T19:09:19.024000000&#39;],
      dtype=&#39;datetime64[ns]&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[159]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%%time
computed_mosaic_da = dask.compute(mosaic_arrays)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 36.6 s, sys: 49.5 s, total: 1min 26s
Wall time: 3min 32s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[161]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>computed_mosaic_da
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[161]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
([&lt;xarray.DataArray (band: 4, y: 7404, x: 20309)&gt;
  dask.array&lt;concatenate, shape=(4, 7404, 20309), dtype=float32, chunksize=(1, 3702, 5792), chunktype=numpy.ndarray&gt;
  Coordinates:
    * x            (x) float64 -121.3 -121.3 -121.3 ... -118.5 -118.5 -118.5
    * y            (y) float64 58.63 58.63 58.63 58.63 ... 57.61 57.61 57.61 57.61
    * band         (band) &lt;U3 &#39;B02&#39; &#39;B03&#39; &#39;B04&#39; &#39;B08&#39;
      spatial_ref  int64 0
  Attributes:
      scales:      (1.0,)
      offsets:     (0.0,)
      _FillValue:  0,
  &lt;xarray.DataArray (band: 4, y: 7404, x: 20309)&gt;
  dask.array&lt;concatenate, shape=(4, 7404, 20309), dtype=float32, chunksize=(1, 3702, 5792), chunktype=numpy.ndarray&gt;
  Coordinates:
    * x            (x) float64 -121.3 -121.3 -121.3 ... -118.5 -118.5 -118.5
    * y            (y) float64 58.63 58.63 58.63 58.63 ... 57.61 57.61 57.61 57.61
    * band         (band) &lt;U3 &#39;B02&#39; &#39;B03&#39; &#39;B04&#39; &#39;B08&#39;
      spatial_ref  int64 0
  Attributes:
      scales:      (1.0,)
      offsets:     (0.0,)
      _FillValue:  0,
  &lt;xarray.DataArray (band: 4, y: 7404, x: 20309)&gt;
  dask.array&lt;concatenate, shape=(4, 7404, 20309), dtype=float32, chunksize=(1, 3702, 5792), chunktype=numpy.ndarray&gt;
  Coordinates:
    * x            (x) float64 -121.3 -121.3 -121.3 ... -118.5 -118.5 -118.5
    * y            (y) float64 58.63 58.63 58.63 58.63 ... 57.61 57.61 57.61 57.61
    * band         (band) &lt;U3 &#39;B02&#39; &#39;B03&#39; &#39;B04&#39; &#39;B08&#39;
      spatial_ref  int64 0
  Attributes:
      scales:      (1.0,)
      offsets:     (0.0,)
      _FillValue:  0,
  &lt;xarray.DataArray (band: 4, y: 7725, x: 21193)&gt;
  dask.array&lt;concatenate, shape=(4, 7725, 21193), dtype=float32, chunksize=(1, 5792, 5792), chunktype=numpy.ndarray&gt;
  Coordinates:
    * x            (x) float64 -121.3 -121.3 -121.3 ... -118.5 -118.5 -118.5
    * y            (y) float64 58.63 58.63 58.63 58.63 ... 57.61 57.61 57.61 57.61
    * band         (band) &lt;U3 &#39;B02&#39; &#39;B03&#39; &#39;B04&#39; &#39;B08&#39;
      spatial_ref  int64 0
  Attributes:
      scales:      (1.0,)
      offsets:     (0.0,)
      _FillValue:  0,
  &lt;xarray.DataArray (band: 4, y: 7725, x: 21193)&gt;
  dask.array&lt;concatenate, shape=(4, 7725, 21193), dtype=float32, chunksize=(1, 5792, 5792), chunktype=numpy.ndarray&gt;
  Coordinates:
    * x            (x) float64 -121.3 -121.3 -121.3 ... -118.5 -118.5 -118.5
    * y            (y) float64 58.63 58.63 58.63 58.63 ... 57.61 57.61 57.61 57.61
    * band         (band) &lt;U3 &#39;B02&#39; &#39;B03&#39; &#39;B04&#39; &#39;B08&#39;
      spatial_ref  int64 0
  Attributes:
      scales:      (1.0,)
      offsets:     (0.0,)
      _FillValue:  0,
  &lt;xarray.DataArray (band: 4, y: 7725, x: 21193)&gt;
  dask.array&lt;concatenate, shape=(4, 7725, 21193), dtype=float32, chunksize=(1, 5792, 5792), chunktype=numpy.ndarray&gt;
  Coordinates:
    * x            (x) float64 -121.3 -121.3 -121.3 ... -118.5 -118.5 -118.5
    * y            (y) float64 58.63 58.63 58.63 58.63 ... 57.61 57.61 57.61 57.61
    * band         (band) &lt;U3 &#39;B02&#39; &#39;B03&#39; &#39;B04&#39; &#39;B08&#39;
      spatial_ref  int64 0
  Attributes:
      scales:      (1.0,)
      offsets:     (0.0,)
      _FillValue:  0,
  &lt;xarray.DataArray (band: 4, y: 7725, x: 21193)&gt;
  dask.array&lt;concatenate, shape=(4, 7725, 21193), dtype=float32, chunksize=(1, 5792, 5792), chunktype=numpy.ndarray&gt;
  Coordinates:
    * x            (x) float64 -121.3 -121.3 -121.3 ... -118.5 -118.5 -118.5
    * y            (y) float64 58.63 58.63 58.63 58.63 ... 57.61 57.61 57.61 57.61
    * band         (band) &lt;U3 &#39;B02&#39; &#39;B03&#39; &#39;B04&#39; &#39;B08&#39;
      spatial_ref  int64 0
  Attributes:
      scales:      (1.0,)
      offsets:     (0.0,)
      _FillValue:  0,
  &lt;xarray.DataArray (band: 4, y: 7725, x: 21193)&gt;
  dask.array&lt;concatenate, shape=(4, 7725, 21193), dtype=float32, chunksize=(1, 5792, 5792), chunktype=numpy.ndarray&gt;
  Coordinates:
    * x            (x) float64 -121.3 -121.3 -121.3 ... -118.5 -118.5 -118.5
    * y            (y) float64 58.63 58.63 58.63 58.63 ... 57.61 57.61 57.61 57.61
    * band         (band) &lt;U3 &#39;B02&#39; &#39;B03&#39; &#39;B04&#39; &#39;B08&#39;
      spatial_ref  int64 0
  Attributes:
      scales:      (1.0,)
      offsets:     (0.0,)
      _FillValue:  0,
  &lt;xarray.DataArray (band: 4, y: 7725, x: 21193)&gt;
  dask.array&lt;concatenate, shape=(4, 7725, 21193), dtype=float32, chunksize=(1, 5792, 5792), chunktype=numpy.ndarray&gt;
  Coordinates:
    * x            (x) float64 -121.3 -121.3 -121.3 ... -118.5 -118.5 -118.5
    * y            (y) float64 58.63 58.63 58.63 58.63 ... 57.61 57.61 57.61 57.61
    * band         (band) &lt;U3 &#39;B02&#39; &#39;B03&#39; &#39;B04&#39; &#39;B08&#39;
      spatial_ref  int64 0
  Attributes:
      scales:      (1.0,)
      offsets:     (0.0,)
      _FillValue:  0,
  &lt;xarray.DataArray (band: 4, y: 7404, x: 20309)&gt;
  dask.array&lt;concatenate, shape=(4, 7404, 20309), dtype=float32, chunksize=(1, 3702, 5792), chunktype=numpy.ndarray&gt;
  Coordinates:
    * x            (x) float64 -121.3 -121.3 -121.3 ... -118.5 -118.5 -118.5
    * y            (y) float64 58.63 58.63 58.63 58.63 ... 57.61 57.61 57.61 57.61
    * band         (band) &lt;U3 &#39;B02&#39; &#39;B03&#39; &#39;B04&#39; &#39;B08&#39;
      spatial_ref  int64 0
  Attributes:
      scales:      (1.0,)
      offsets:     (0.0,)
      _FillValue:  0],)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[124]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>rgb = color_composite(concated, &#39;B04&#39;, &#39;B03&#39;, &#39;B02&#39;, 5)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[125]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>rgb.plot.imshow()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[125]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.image.AxesImage at 0x7f15a0db0d30&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/3_scientific_workflows_02-knn_43_2.png" src="../_images/3_scientific_workflows_02-knn_43_2.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[115]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.unique(b2)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[115]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.0000e+00, 1.0000e+00, 2.0000e+00, ..., 1.2024e+04, 1.2128e+04,
       1.2200e+04])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[116]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>concat[0].plot.imshow()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[116]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.image.AxesImage at 0x7f15a0dd5250&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/3_scientific_workflows_02-knn_45_1.png" src="../_images/3_scientific_workflows_02-knn_45_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[166]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#@dask.delayed
def get_comp(dates_array, dates):
    # Concat all the Arrays along the dimension based on the dates
    dates_ds = xr.concat(dates_array[0], dim=pd.DatetimeIndex(dates, name=&#39;time&#39;))
    dates_ds.data[(dates_ds.data == -9999)] = np.nan # Change Fill Value to NaN

    return dates_ds
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[168]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>comp = get_comp(computed_mosaic_da, dates)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/indexing.py:1233: PerformanceWarning: Slicing is producing a large chunk. To accept the large
chunk and silence this warning, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: False}):
    ...     array[indexer]

To avoid creating the large chunks, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: True}):
    ...     array[indexer]
  value = value[(slice(None),) * axis + (subkey,)]
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/indexing.py:1233: PerformanceWarning: Slicing is producing a large chunk. To accept the large
chunk and silence this warning, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: False}):
    ...     array[indexer]

To avoid creating the large chunks, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: True}):
    ...     array[indexer]
  value = value[(slice(None),) * axis + (subkey,)]
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/indexing.py:1233: PerformanceWarning: Slicing is producing a large chunk. To accept the large
chunk and silence this warning, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: False}):
    ...     array[indexer]

To avoid creating the large chunks, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: True}):
    ...     array[indexer]
  value = value[(slice(None),) * axis + (subkey,)]
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/indexing.py:1233: PerformanceWarning: Slicing is producing a large chunk. To accept the large
chunk and silence this warning, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: False}):
    ...     array[indexer]

To avoid creating the large chunks, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: True}):
    ...     array[indexer]
  value = value[(slice(None),) * axis + (subkey,)]
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/indexing.py:1233: PerformanceWarning: Slicing is producing a large chunk. To accept the large
chunk and silence this warning, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: False}):
    ...     array[indexer]

To avoid creating the large chunks, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: True}):
    ...     array[indexer]
  value = value[(slice(None),) * axis + (subkey,)]
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/indexing.py:1233: PerformanceWarning: Slicing is producing a large chunk. To accept the large
chunk and silence this warning, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: False}):
    ...     array[indexer]

To avoid creating the large chunks, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: True}):
    ...     array[indexer]
  value = value[(slice(None),) * axis + (subkey,)]
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/indexing.py:1233: PerformanceWarning: Slicing is producing a large chunk. To accept the large
chunk and silence this warning, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: False}):
    ...     array[indexer]

To avoid creating the large chunks, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: True}):
    ...     array[indexer]
  value = value[(slice(None),) * axis + (subkey,)]
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/indexing.py:1233: PerformanceWarning: Slicing is producing a large chunk. To accept the large
chunk and silence this warning, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: False}):
    ...     array[indexer]

To avoid creating the large chunks, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: True}):
    ...     array[indexer]
  value = value[(slice(None),) * axis + (subkey,)]
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/indexing.py:1233: PerformanceWarning: Slicing is producing a large chunk. To accept the large
chunk and silence this warning, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: False}):
    ...     array[indexer]

To avoid creating the large chunks, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: True}):
    ...     array[indexer]
  value = value[(slice(None),) * axis + (subkey,)]
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/indexing.py:1233: PerformanceWarning: Slicing is producing a large chunk. To accept the large
chunk and silence this warning, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: False}):
    ...     array[indexer]

To avoid creating the large chunks, set the option
    &gt;&gt;&gt; with dask.config.set(**{&#39;array.slicing.split_large_chunks&#39;: True}):
    ...     array[indexer]
  value = value[(slice(None),) * axis + (subkey,)]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[169]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>comp
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[169]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 10, band: 4, y: 15129, x: 41502)&gt;
dask.array&lt;where, shape=(10, 4, 15129, 41502), dtype=float32, chunksize=(1, 1, 7565, 11343), chunktype=numpy.ndarray&gt;
Coordinates:
  * x            (x) float64 -121.3 -121.3 -121.3 ... -118.5 -118.5 -118.5
  * y            (y) float64 57.61 57.61 57.61 57.61 ... 58.63 58.63 58.63 58.63
  * band         (band) &lt;U3 &#x27;B02&#x27; &#x27;B03&#x27; &#x27;B04&#x27; &#x27;B08&#x27;
    spatial_ref  int64 0
  * time         (time) datetime64[ns] 2021-06-19T19:09:19.024000 ... 2021-07...
Attributes:
    scales:      (1.0,)
    offsets:     (0.0,)
    _FillValue:  0</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 10</li><li><span class='xr-has-index'>band</span>: 4</li><li><span class='xr-has-index'>y</span>: 15129</li><li><span class='xr-has-index'>x</span>: 41502</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-edcfeb8e-b01e-41f7-a1b2-92f3ee547610' class='xr-array-in' type='checkbox' checked><label for='section-edcfeb8e-b01e-41f7-a1b2-92f3ee547610' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 1, 3787, 11343), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 93.56 GiB </td>
                        <td> 327.34 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (10, 4, 15129, 41502) </td>
                        <td> (1, 1, 7565, 11343) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 6896 Tasks </td>
                        <td> 840 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="374" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="2" y1="0" x2="2" y2="25" />
  <line x1="5" y1="0" x2="5" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="10" y1="0" x2="10" y2="25" />
  <line x1="12" y1="0" x2="12" y2="25" />
  <line x1="15" y1="0" x2="15" y2="25" />
  <line x1="17" y1="0" x2="17" y2="25" />
  <line x1="20" y1="0" x2="20" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >10</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="109" y2="14" style="stroke-width:2" />
  <line x1="95" y1="11" x2="109" y2="26" />
  <line x1="95" y1="22" x2="109" y2="37" />
  <line x1="95" y1="44" x2="109" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="44" style="stroke-width:2" />
  <line x1="98" y1="3" x2="98" y2="47" />
  <line x1="102" y1="7" x2="102" y2="51" />
  <line x1="106" y1="11" x2="106" y2="55" />
  <line x1="109" y1="14" x2="109" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 109.9485979497544,14.948597949754403 109.9485979497544,59.10598435882734 95.0,44.15738640907294" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="215" y2="0" style="stroke-width:2" />
  <line x1="98" y1="3" x2="218" y2="3" />
  <line x1="102" y1="7" x2="222" y2="7" />
  <line x1="106" y1="11" x2="226" y2="11" />
  <line x1="109" y1="14" x2="229" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="109" y2="14" style="stroke-width:2" />
  <line x1="127" y1="0" x2="142" y2="14" />
  <line x1="129" y1="0" x2="144" y2="14" />
  <line x1="160" y1="0" x2="175" y2="14" />
  <line x1="163" y1="0" x2="178" y2="14" />
  <line x1="193" y1="0" x2="208" y2="14" />
  <line x1="197" y1="0" x2="212" y2="14" />
  <line x1="215" y1="0" x2="229" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 215.0,0.0 229.9485979497544,14.948597949754403 109.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="109" y1="14" x2="229" y2="14" style="stroke-width:2" />
  <line x1="109" y1="26" x2="229" y2="26" />
  <line x1="109" y1="37" x2="229" y2="37" />
  <line x1="109" y1="59" x2="229" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="109" y1="14" x2="109" y2="59" style="stroke-width:2" />
  <line x1="142" y1="14" x2="142" y2="59" />
  <line x1="144" y1="14" x2="144" y2="59" />
  <line x1="175" y1="14" x2="175" y2="59" />
  <line x1="178" y1="14" x2="178" y2="59" />
  <line x1="208" y1="14" x2="208" y2="59" />
  <line x1="212" y1="14" x2="212" y2="59" />
  <line x1="229" y1="14" x2="229" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="109.9485979497544,14.948597949754403 229.9485979497544,14.948597949754403 229.9485979497544,59.10598435882734 109.9485979497544,59.10598435882734" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="169.948598" y="79.105984" font-size="1.0rem" font-weight="100" text-anchor="middle" >41502</text>
  <text x="249.948598" y="37.027291" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,249.948598,37.027291)">15129</text>
  <text x="92.474299" y="71.631685" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,92.474299,71.631685)">4</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-b7a9abd0-531c-4b43-9b09-1b3a4837cca1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b7a9abd0-531c-4b43-9b09-1b3a4837cca1' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-121.3 -121.3 ... -118.5 -118.5</div><input id='attrs-dcc550dc-ef53-4e8a-8f68-a043cc9e7591' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dcc550dc-ef53-4e8a-8f68-a043cc9e7591' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d3890765-f1e6-4e18-8316-eecba176d30e' class='xr-var-data-in' type='checkbox'><label for='data-d3890765-f1e6-4e18-8316-eecba176d30e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-121.324671, -121.324668, -121.324538, ..., -118.511265, -118.511155,
       -118.511132])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>57.61 57.61 57.61 ... 58.63 58.63</div><input id='attrs-d6a3f187-8b7a-4511-b160-7795aee80aa7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d6a3f187-8b7a-4511-b160-7795aee80aa7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a529e4cb-5267-44ae-a324-3d657097410a' class='xr-var-data-in' type='checkbox'><label for='data-a529e4cb-5267-44ae-a324-3d657097410a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([57.605582, 57.60572 , 57.605741, ..., 58.631079, 58.631209, 58.631212])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>band</span></div><div class='xr-var-dims'>(band)</div><div class='xr-var-dtype'>&lt;U3</div><div class='xr-var-preview xr-preview'>&#x27;B02&#x27; &#x27;B03&#x27; &#x27;B04&#x27; &#x27;B08&#x27;</div><input id='attrs-1a873323-93b1-475e-92c8-bd9b2a3540ec' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1a873323-93b1-475e-92c8-bd9b2a3540ec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-379ad955-d44a-4c17-8bcf-aeb8d3294ba9' class='xr-var-data-in' type='checkbox'><label for='data-379ad955-d44a-4c17-8bcf-aeb8d3294ba9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;B02&#x27;, &#x27;B03&#x27;, &#x27;B04&#x27;, &#x27;B08&#x27;], dtype=&#x27;&lt;U3&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-ebd2c939-3246-4fd0-9d60-38fe19c06a08' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ebd2c939-3246-4fd0-9d60-38fe19c06a08' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f5372e76-05ad-49b7-aa13-58eaecb719cf' class='xr-var-data-in' type='checkbox'><label for='data-f5372e76-05ad-49b7-aa13-58eaecb719cf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>spatial_ref :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>-121.32473697904234 0.00013854208588375526 0.0 58.63127807853668 0.0 -0.00013854208588375574</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2021-06-19T19:09:19.024000 ... 2...</div><input id='attrs-1f8cc8ea-bc7c-4086-992b-b610807b356a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1f8cc8ea-bc7c-4086-992b-b610807b356a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a488766a-d723-448f-a144-819d8cedc702' class='xr-var-data-in' type='checkbox'><label for='data-a488766a-d723-448f-a144-819d8cedc702' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2021-06-19T19:09:19.024000000&#x27;, &#x27;2021-06-25T19:29:09.024000000&#x27;,
       &#x27;2021-06-27T19:19:11.024000000&#x27;, &#x27;2021-06-29T19:09:19.024000000&#x27;,
       &#x27;2021-06-30T19:29:11.024000000&#x27;, &#x27;2021-07-05T19:29:09.024000000&#x27;,
       &#x27;2021-07-09T19:09:19.024000000&#x27;, &#x27;2021-07-24T19:09:21.024000000&#x27;,
       &#x27;2021-07-25T19:29:09.024000000&#x27;, &#x27;2021-07-29T19:09:19.024000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-12aedddf-17fb-4aeb-aef1-17d057416708' class='xr-section-summary-in' type='checkbox'  checked><label for='section-12aedddf-17fb-4aeb-aef1-17d057416708' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>scales :</span></dt><dd>(1.0,)</dd><dt><span>offsets :</span></dt><dd>(0.0,)</dd><dt><span>_FillValue :</span></dt><dd>0</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>computed_composite = comp.compute()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_359/814558245.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>computed_composite <span class="ansi-blue-fg">=</span> comp<span class="ansi-blue-fg">.</span>compute<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/dask/base.py</span> in <span class="ansi-cyan-fg">compute</span><span class="ansi-blue-fg">(self, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    286</span>         dask<span class="ansi-blue-fg">.</span>base<span class="ansi-blue-fg">.</span>compute
<span class="ansi-green-intense-fg ansi-bold">    287</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 288</span><span class="ansi-red-fg">         </span><span class="ansi-blue-fg">(</span>result<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">=</span> compute<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> traverse<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    289</span>         <span class="ansi-green-fg">return</span> result
<span class="ansi-green-intense-fg ansi-bold">    290</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/dask/base.py</span> in <span class="ansi-cyan-fg">compute</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    568</span>         postcomputes<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">.</span>__dask_postcompute__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    569</span>
<span class="ansi-green-fg">--&gt; 570</span><span class="ansi-red-fg">     </span>results <span class="ansi-blue-fg">=</span> schedule<span class="ansi-blue-fg">(</span>dsk<span class="ansi-blue-fg">,</span> keys<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    571</span>     <span class="ansi-green-fg">return</span> repack<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>f<span class="ansi-blue-fg">(</span>r<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>a<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> r<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span> a<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">in</span> zip<span class="ansi-blue-fg">(</span>results<span class="ansi-blue-fg">,</span> postcomputes<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    572</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/client.py</span> in <span class="ansi-cyan-fg">get</span><span class="ansi-blue-fg">(self, dsk, keys, workers, allow_other_workers, resources, sync, asynchronous, direct, retries, priority, fifo_timeout, actors, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2720</span>                     should_rejoin <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span>
<span class="ansi-green-intense-fg ansi-bold">   2721</span>             <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 2722</span><span class="ansi-red-fg">                 </span>results <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>gather<span class="ansi-blue-fg">(</span>packed<span class="ansi-blue-fg">,</span> asynchronous<span class="ansi-blue-fg">=</span>asynchronous<span class="ansi-blue-fg">,</span> direct<span class="ansi-blue-fg">=</span>direct<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2723</span>             <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2724</span>                 <span class="ansi-green-fg">for</span> f <span class="ansi-green-fg">in</span> futures<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/client.py</span> in <span class="ansi-cyan-fg">gather</span><span class="ansi-blue-fg">(self, futures, errors, direct, asynchronous)</span>
<span class="ansi-green-intense-fg ansi-bold">   1975</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1976</span>                 local_worker <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-fg">-&gt; 1977</span><span class="ansi-red-fg">             return self.sync(
</span><span class="ansi-green-intense-fg ansi-bold">   1978</span>                 self<span class="ansi-blue-fg">.</span>_gather<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   1979</span>                 futures<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/client.py</span> in <span class="ansi-cyan-fg">sync</span><span class="ansi-blue-fg">(self, func, asynchronous, callback_timeout, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    863</span>             <span class="ansi-green-fg">return</span> future
<span class="ansi-green-intense-fg ansi-bold">    864</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 865</span><span class="ansi-red-fg">             return sync(
</span><span class="ansi-green-intense-fg ansi-bold">    866</span>                 self<span class="ansi-blue-fg">.</span>loop<span class="ansi-blue-fg">,</span> func<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> callback_timeout<span class="ansi-blue-fg">=</span>callback_timeout<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs
<span class="ansi-green-intense-fg ansi-bold">    867</span>             )

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/utils.py</span> in <span class="ansi-cyan-fg">sync</span><span class="ansi-blue-fg">(loop, func, callback_timeout, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    325</span>     <span class="ansi-green-fg">if</span> error<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    326</span>         typ<span class="ansi-blue-fg">,</span> exc<span class="ansi-blue-fg">,</span> tb <span class="ansi-blue-fg">=</span> error<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">--&gt; 327</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">raise</span> exc<span class="ansi-blue-fg">.</span>with_traceback<span class="ansi-blue-fg">(</span>tb<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    328</span>     <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    329</span>         <span class="ansi-green-fg">return</span> result<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/utils.py</span> in <span class="ansi-cyan-fg">f</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">    308</span>             <span class="ansi-green-fg">if</span> callback_timeout <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    309</span>                 future <span class="ansi-blue-fg">=</span> asyncio<span class="ansi-blue-fg">.</span>wait_for<span class="ansi-blue-fg">(</span>future<span class="ansi-blue-fg">,</span> callback_timeout<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 310</span><span class="ansi-red-fg">             </span>result<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">yield</span> future
<span class="ansi-green-intense-fg ansi-bold">    311</span>         <span class="ansi-green-fg">except</span> Exception<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    312</span>             error<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> sys<span class="ansi-blue-fg">.</span>exc_info<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/tornado/gen.py</span> in <span class="ansi-cyan-fg">run</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    760</span>
<span class="ansi-green-intense-fg ansi-bold">    761</span>                     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 762</span><span class="ansi-red-fg">                         </span>value <span class="ansi-blue-fg">=</span> future<span class="ansi-blue-fg">.</span>result<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    763</span>                     <span class="ansi-green-fg">except</span> Exception<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    764</span>                         exc_info <span class="ansi-blue-fg">=</span> sys<span class="ansi-blue-fg">.</span>exc_info<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/client.py</span> in <span class="ansi-cyan-fg">_gather</span><span class="ansi-blue-fg">(self, futures, errors, direct, local_worker)</span>
<span class="ansi-green-intense-fg ansi-bold">   1840</span>                             exc <span class="ansi-blue-fg">=</span> CancelledError<span class="ansi-blue-fg">(</span>key<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1841</span>                         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1842</span><span class="ansi-red-fg">                             </span><span class="ansi-green-fg">raise</span> exception<span class="ansi-blue-fg">.</span>with_traceback<span class="ansi-blue-fg">(</span>traceback<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1843</span>                         <span class="ansi-green-fg">raise</span> exc
<span class="ansi-green-intense-fg ansi-bold">   1844</span>                     <span class="ansi-green-fg">if</span> errors <span class="ansi-blue-fg">==</span> <span class="ansi-blue-fg">&#34;skip&#34;</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/tmp/ipykernel_359/22482287.py</span> in <span class="ansi-cyan-fg">projecting</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span>         reproj <span class="ansi-blue-fg">=</span> array<span class="ansi-blue-fg">.</span>rio<span class="ansi-blue-fg">.</span>reproject<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;EPSG:4326&#39;</span><span class="ansi-blue-fg">,</span> resolution<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">10</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">10</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span>     <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">----&gt; 9</span><span class="ansi-red-fg">         </span>reproj <span class="ansi-blue-fg">=</span> array<span class="ansi-blue-fg">.</span>rio<span class="ansi-blue-fg">.</span>reproject<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;EPSG:4326&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span>     <span class="ansi-green-fg">return</span> reproj

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/rioxarray/raster_array.py</span> in <span class="ansi-cyan-fg">reproject</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">    422</span>
<span class="ansi-green-intense-fg ansi-bold">    423</span>         rasterio.warp.reproject(
<span class="ansi-green-fg">--&gt; 424</span><span class="ansi-red-fg">             </span>source<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>_obj<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    425</span>             destination<span class="ansi-blue-fg">=</span>dst_data<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    426</span>             src_transform<span class="ansi-blue-fg">=</span>src_affine<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/dataarray.py</span> in <span class="ansi-cyan-fg">values</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">    644</span>         type does <span class="ansi-green-fg">not</span> support coercion like this <span class="ansi-blue-fg">(</span>e<span class="ansi-blue-fg">.</span>g<span class="ansi-blue-fg">.</span> cupy<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>
<span class="ansi-green-intense-fg ansi-bold">    645</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 646</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>variable<span class="ansi-blue-fg">.</span>values
<span class="ansi-green-intense-fg ansi-bold">    647</span>
<span class="ansi-green-intense-fg ansi-bold">    648</span>     <span class="ansi-blue-fg">@</span>values<span class="ansi-blue-fg">.</span>setter

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/variable.py</span> in <span class="ansi-cyan-fg">values</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">    517</span>     <span class="ansi-green-fg">def</span> values<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    518</span>         <span class="ansi-blue-fg">&#34;&#34;&#34;The variable&#39;s data as a numpy.ndarray&#34;&#34;&#34;</span>
<span class="ansi-green-fg">--&gt; 519</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> _as_array_or_item<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_data<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    520</span>
<span class="ansi-green-intense-fg ansi-bold">    521</span>     <span class="ansi-blue-fg">@</span>values<span class="ansi-blue-fg">.</span>setter

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/variable.py</span> in <span class="ansi-cyan-fg">_as_array_or_item</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">    257</span>     TODO<span class="ansi-blue-fg">:</span> remove this <span class="ansi-blue-fg">(</span>replace <span class="ansi-green-fg">with</span> np<span class="ansi-blue-fg">.</span>asarray<span class="ansi-blue-fg">)</span> once these issues are fixed
<span class="ansi-green-intense-fg ansi-bold">    258</span>     &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 259</span><span class="ansi-red-fg">     </span>data <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>asarray<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    260</span>     <span class="ansi-green-fg">if</span> data<span class="ansi-blue-fg">.</span>ndim <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    261</span>         <span class="ansi-green-fg">if</span> data<span class="ansi-blue-fg">.</span>dtype<span class="ansi-blue-fg">.</span>kind <span class="ansi-blue-fg">==</span> <span class="ansi-blue-fg">&#34;M&#34;</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/dask/array/core.py</span> in <span class="ansi-cyan-fg">__array__</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">   1532</span>
<span class="ansi-green-intense-fg ansi-bold">   1533</span>     <span class="ansi-green-fg">def</span> __array__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1534</span><span class="ansi-red-fg">         </span>x <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>compute<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1535</span>         <span class="ansi-green-fg">if</span> dtype <span class="ansi-green-fg">and</span> x<span class="ansi-blue-fg">.</span>dtype <span class="ansi-blue-fg">!=</span> dtype<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1536</span>             x <span class="ansi-blue-fg">=</span> x<span class="ansi-blue-fg">.</span>astype<span class="ansi-blue-fg">(</span>dtype<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/dask/base.py</span> in <span class="ansi-cyan-fg">compute</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">    286</span>         dask<span class="ansi-blue-fg">.</span>base<span class="ansi-blue-fg">.</span>compute
<span class="ansi-green-intense-fg ansi-bold">    287</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 288</span><span class="ansi-red-fg">         </span><span class="ansi-blue-fg">(</span>result<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">=</span> compute<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> traverse<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    289</span>         <span class="ansi-green-fg">return</span> result
<span class="ansi-green-intense-fg ansi-bold">    290</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/dask/base.py</span> in <span class="ansi-cyan-fg">compute</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">    568</span>         postcomputes<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">.</span>__dask_postcompute__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    569</span>
<span class="ansi-green-fg">--&gt; 570</span><span class="ansi-red-fg">     </span>results <span class="ansi-blue-fg">=</span> schedule<span class="ansi-blue-fg">(</span>dsk<span class="ansi-blue-fg">,</span> keys<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    571</span>     <span class="ansi-green-fg">return</span> repack<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>f<span class="ansi-blue-fg">(</span>r<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>a<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> r<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span> a<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">in</span> zip<span class="ansi-blue-fg">(</span>results<span class="ansi-blue-fg">,</span> postcomputes<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    572</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/client.py</span> in <span class="ansi-cyan-fg">get</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">   2720</span>                     should_rejoin <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span>
<span class="ansi-green-intense-fg ansi-bold">   2721</span>             <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 2722</span><span class="ansi-red-fg">                 </span>results <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>gather<span class="ansi-blue-fg">(</span>packed<span class="ansi-blue-fg">,</span> asynchronous<span class="ansi-blue-fg">=</span>asynchronous<span class="ansi-blue-fg">,</span> direct<span class="ansi-blue-fg">=</span>direct<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2723</span>             <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2724</span>                 <span class="ansi-green-fg">for</span> f <span class="ansi-green-fg">in</span> futures<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/client.py</span> in <span class="ansi-cyan-fg">gather</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">   1975</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1976</span>                 local_worker <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-fg">-&gt; 1977</span><span class="ansi-red-fg">             return self.sync(
</span><span class="ansi-green-intense-fg ansi-bold">   1978</span>                 self<span class="ansi-blue-fg">.</span>_gather<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   1979</span>                 futures<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/client.py</span> in <span class="ansi-cyan-fg">sync</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">    863</span>             <span class="ansi-green-fg">return</span> future
<span class="ansi-green-intense-fg ansi-bold">    864</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 865</span><span class="ansi-red-fg">             return sync(
</span><span class="ansi-green-intense-fg ansi-bold">    866</span>                 self<span class="ansi-blue-fg">.</span>loop<span class="ansi-blue-fg">,</span> func<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> callback_timeout<span class="ansi-blue-fg">=</span>callback_timeout<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs
<span class="ansi-green-intense-fg ansi-bold">    867</span>             )

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/utils.py</span> in <span class="ansi-cyan-fg">sync</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">    325</span>     <span class="ansi-green-fg">if</span> error<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    326</span>         typ<span class="ansi-blue-fg">,</span> exc<span class="ansi-blue-fg">,</span> tb <span class="ansi-blue-fg">=</span> error<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">--&gt; 327</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">raise</span> exc<span class="ansi-blue-fg">.</span>with_traceback<span class="ansi-blue-fg">(</span>tb<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    328</span>     <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    329</span>         <span class="ansi-green-fg">return</span> result<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/utils.py</span> in <span class="ansi-cyan-fg">f</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">    308</span>             <span class="ansi-green-fg">if</span> callback_timeout <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    309</span>                 future <span class="ansi-blue-fg">=</span> asyncio<span class="ansi-blue-fg">.</span>wait_for<span class="ansi-blue-fg">(</span>future<span class="ansi-blue-fg">,</span> callback_timeout<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 310</span><span class="ansi-red-fg">             </span>result<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">yield</span> future
<span class="ansi-green-intense-fg ansi-bold">    311</span>         <span class="ansi-green-fg">except</span> Exception<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    312</span>             error<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> sys<span class="ansi-blue-fg">.</span>exc_info<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/tornado/gen.py</span> in <span class="ansi-cyan-fg">run</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">    760</span>
<span class="ansi-green-intense-fg ansi-bold">    761</span>                     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 762</span><span class="ansi-red-fg">                         </span>value <span class="ansi-blue-fg">=</span> future<span class="ansi-blue-fg">.</span>result<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    763</span>                     <span class="ansi-green-fg">except</span> Exception<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    764</span>                         exc_info <span class="ansi-blue-fg">=</span> sys<span class="ansi-blue-fg">.</span>exc_info<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/client.py</span> in <span class="ansi-cyan-fg">_gather</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">   1869</span>                 <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1870</span>                     self<span class="ansi-blue-fg">.</span>_gather_future <span class="ansi-blue-fg">=</span> future
<span class="ansi-green-fg">-&gt; 1871</span><span class="ansi-red-fg">                 </span>response <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">await</span> future
<span class="ansi-green-intense-fg ansi-bold">   1872</span>
<span class="ansi-green-intense-fg ansi-bold">   1873</span>             <span class="ansi-green-fg">if</span> response<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;status&#34;</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">==</span> <span class="ansi-blue-fg">&#34;error&#34;</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/client.py</span> in <span class="ansi-cyan-fg">_gather_remote</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">   1909</span>             <span class="ansi-green-fg">if</span> direct <span class="ansi-green-fg">or</span> local_worker<span class="ansi-blue-fg">:</span>  <span class="ansi-red-fg"># gather directly from workers</span>
<span class="ansi-green-intense-fg ansi-bold">   1910</span>                 who_has <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">await</span> retry_operation<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>scheduler<span class="ansi-blue-fg">.</span>who_has<span class="ansi-blue-fg">,</span> keys<span class="ansi-blue-fg">=</span>keys<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 1911</span><span class="ansi-red-fg">                 data2, missing_keys, missing_workers = await gather_from_workers(
</span><span class="ansi-green-intense-fg ansi-bold">   1912</span>                     who_has<span class="ansi-blue-fg">,</span> rpc<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>rpc<span class="ansi-blue-fg">,</span> close<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span>
<span class="ansi-green-intense-fg ansi-bold">   1913</span>                 )

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/utils_comm.py</span> in <span class="ansi-cyan-fg">gather_from_workers</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     86</span>                     missing_workers<span class="ansi-blue-fg">.</span>add<span class="ansi-blue-fg">(</span>worker<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     87</span>                 <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 88</span><span class="ansi-red-fg">                     </span>response<span class="ansi-blue-fg">.</span>update<span class="ansi-blue-fg">(</span>r<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;data&#34;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     89</span>         <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     90</span>             <span class="ansi-green-fg">for</span> r <span class="ansi-green-fg">in</span> rpcs<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">KeyError</span>: &#39;data&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[170]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def get_median(dates_ds):
    # Compute the Median (skipping pixels with NaN)
    median_ds = dates_ds.median(dim=&#39;time&#39;, skipna=True)

    return median_ds
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[171]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>med_ds = get_median(comp)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[173]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.unique(med_ds)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[173]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.000e+00, 5.000e-01, 1.000e+00, ..., 7.159e+03, 7.176e+03,
             nan], dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[182]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>med_ds.chunk(&#39;auto&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[182]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (band: 4, y: 15129, x: 41502)&gt;
dask.array&lt;rechunk-merge, shape=(4, 15129, 41502), dtype=float32, chunksize=(2, 2666, 5032), chunktype=numpy.ndarray&gt;
Coordinates:
  * x            (x) float64 -121.3 -121.3 -121.3 ... -118.5 -118.5 -118.5
  * y            (y) float64 57.61 57.61 57.61 57.61 ... 58.63 58.63 58.63 58.63
  * band         (band) &lt;U3 &#x27;B02&#x27; &#x27;B03&#x27; &#x27;B04&#x27; &#x27;B08&#x27;
    spatial_ref  int64 0</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>band</span>: 4</li><li><span class='xr-has-index'>y</span>: 15129</li><li><span class='xr-has-index'>x</span>: 41502</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-098a60b0-2165-48fc-a2b8-1f021a4f4b3d' class='xr-array-in' type='checkbox' checked><label for='section-098a60b0-2165-48fc-a2b8-1f021a4f4b3d' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(2, 2666, 5032), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 9.36 GiB </td>
                        <td> 102.35 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (4, 15129, 41502) </td>
                        <td> (2, 2666, 5032) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 21516 Tasks </td>
                        <td> 108 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="7" x2="24" y2="22" />
  <line x1="10" y1="15" x2="24" y2="30" />
  <line x1="10" y1="23" x2="24" y2="38" />
  <line x1="10" y1="31" x2="24" y2="46" />
  <line x1="10" y1="38" x2="24" y2="53" />
  <line x1="10" y1="44" x2="24" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="44" style="stroke-width:2" />
  <line x1="17" y1="7" x2="17" y2="51" />
  <line x1="24" y1="14" x2="24" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,59.10598435882734 10.0,44.15738640907294" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="24" y1="0" x2="39" y2="14" />
  <line x1="39" y1="0" x2="54" y2="14" />
  <line x1="53" y1="0" x2="68" y2="14" />
  <line x1="68" y1="0" x2="83" y2="14" />
  <line x1="82" y1="0" x2="97" y2="14" />
  <line x1="97" y1="0" x2="112" y2="14" />
  <line x1="111" y1="0" x2="126" y2="14" />
  <line x1="126" y1="0" x2="141" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="22" x2="144" y2="22" />
  <line x1="24" y1="30" x2="144" y2="30" />
  <line x1="24" y1="38" x2="144" y2="38" />
  <line x1="24" y1="46" x2="144" y2="46" />
  <line x1="24" y1="53" x2="144" y2="53" />
  <line x1="24" y1="59" x2="144" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="59" style="stroke-width:2" />
  <line x1="39" y1="14" x2="39" y2="59" />
  <line x1="54" y1="14" x2="54" y2="59" />
  <line x1="68" y1="14" x2="68" y2="59" />
  <line x1="83" y1="14" x2="83" y2="59" />
  <line x1="97" y1="14" x2="97" y2="59" />
  <line x1="112" y1="14" x2="112" y2="59" />
  <line x1="126" y1="14" x2="126" y2="59" />
  <line x1="141" y1="14" x2="141" y2="59" />
  <line x1="144" y1="14" x2="144" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,59.10598435882734 24.9485979497544,59.10598435882734" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="79.105984" font-size="1.0rem" font-weight="100" text-anchor="middle" >41502</text>
  <text x="164.948598" y="37.027291" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,37.027291)">15129</text>
  <text x="7.474299" y="71.631685" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,71.631685)">4</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-7cb8fd9b-d8c0-4bbe-96a9-2d3207518731' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7cb8fd9b-d8c0-4bbe-96a9-2d3207518731' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-121.3 -121.3 ... -118.5 -118.5</div><input id='attrs-de372162-8eaa-4c0e-818c-30609efcfc91' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-de372162-8eaa-4c0e-818c-30609efcfc91' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-76e5707d-96c3-41cd-ace1-573fa5197e43' class='xr-var-data-in' type='checkbox'><label for='data-76e5707d-96c3-41cd-ace1-573fa5197e43' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-121.324671, -121.324668, -121.324538, ..., -118.511265, -118.511155,
       -118.511132])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>57.61 57.61 57.61 ... 58.63 58.63</div><input id='attrs-63d8e3c4-2d0d-4c15-b3c3-3fc89df7f571' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-63d8e3c4-2d0d-4c15-b3c3-3fc89df7f571' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-16896cec-b90d-43cb-b1a4-6b17351dc915' class='xr-var-data-in' type='checkbox'><label for='data-16896cec-b90d-43cb-b1a4-6b17351dc915' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([57.605582, 57.60572 , 57.605741, ..., 58.631079, 58.631209, 58.631212])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>band</span></div><div class='xr-var-dims'>(band)</div><div class='xr-var-dtype'>&lt;U3</div><div class='xr-var-preview xr-preview'>&#x27;B02&#x27; &#x27;B03&#x27; &#x27;B04&#x27; &#x27;B08&#x27;</div><input id='attrs-01445b0d-89ee-4cd5-83ee-b6814a3d67a2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-01445b0d-89ee-4cd5-83ee-b6814a3d67a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-31167c83-cdae-4b91-b511-ce1c4d49878e' class='xr-var-data-in' type='checkbox'><label for='data-31167c83-cdae-4b91-b511-ce1c4d49878e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;B02&#x27;, &#x27;B03&#x27;, &#x27;B04&#x27;, &#x27;B08&#x27;], dtype=&#x27;&lt;U3&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-339addaa-7b20-473f-b311-d61864fb6210' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-339addaa-7b20-473f-b311-d61864fb6210' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-980fde56-cf10-44e2-9776-4357b18f31c6' class='xr-var-data-in' type='checkbox'><label for='data-980fde56-cf10-44e2-9776-4357b18f31c6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>spatial_ref :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>-121.32473697904234 0.00013854208588375526 0.0 58.63127807853668 0.0 -0.00013854208588375574</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bca88c72-5c26-401c-943a-25b19628ca6c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-bca88c72-5c26-401c-943a-25b19628ca6c' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[181]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>med_ds.rio.to_raster(&#39;median_composite.tif&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">CPLE_FileIOError</span>                          Traceback (most recent call last)
<span class="ansi-green-fg">rasterio/_io.pyx</span> in <span class="ansi-cyan-fg">rasterio._io.DatasetWriterBase.__init__</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">rasterio/_err.pyx</span> in <span class="ansi-cyan-fg">rasterio._err.exc_wrap_pointer</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">CPLE_FileIOError</span>: median_composite.tif: Free disk space available is 7437549568 bytes, whereas 10046140128 are at least necessary. You can disable this check by defining the CHECK_DISK_FREE_SPACE configuration option to FALSE.

During handling of the above exception, another exception occurred:

<span class="ansi-red-fg">RasterioIOError</span>                           Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_359/869580526.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>med_ds<span class="ansi-blue-fg">.</span>rio<span class="ansi-blue-fg">.</span>to_raster<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;median_composite.tif&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/rioxarray/raster_array.py</span> in <span class="ansi-cyan-fg">to_raster</span><span class="ansi-blue-fg">(self, raster_path, driver, dtype, tags, windowed, recalc_transform, lock, compute, **profile_kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    976</span>         )
<span class="ansi-green-intense-fg ansi-bold">    977</span>
<span class="ansi-green-fg">--&gt; 978</span><span class="ansi-red-fg">         return RasterioWriter(raster_path=raster_path).to_raster(
</span><span class="ansi-green-intense-fg ansi-bold">    979</span>             xarray_dataarray<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>_obj<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    980</span>             tags<span class="ansi-blue-fg">=</span>tags<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/rioxarray/raster_writer.py</span> in <span class="ansi-cyan-fg">to_raster</span><span class="ansi-blue-fg">(self, xarray_dataarray, tags, windowed, lock, compute, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    235</span>             kwargs<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;nodata&#34;</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> _ensure_nodata_dtype<span class="ansi-blue-fg">(</span>kwargs<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;nodata&#34;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> numpy_dtype<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    236</span>
<span class="ansi-green-fg">--&gt; 237</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">with</span> rasterio<span class="ansi-blue-fg">.</span>open<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>raster_path<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;w&#34;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> rds<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    238</span>             _write_metatata_to_raster<span class="ansi-blue-fg">(</span>rds<span class="ansi-blue-fg">,</span> xarray_dataarray<span class="ansi-blue-fg">,</span> tags<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    239</span>             <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> <span class="ansi-blue-fg">(</span>lock <span class="ansi-green-fg">and</span> is_dask_collection<span class="ansi-blue-fg">(</span>xarray_dataarray<span class="ansi-blue-fg">.</span>data<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/rasterio/env.py</span> in <span class="ansi-cyan-fg">wrapper</span><span class="ansi-blue-fg">(*args, **kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">    435</span>
<span class="ansi-green-intense-fg ansi-bold">    436</span>         <span class="ansi-green-fg">with</span> env_ctor<span class="ansi-blue-fg">(</span>session<span class="ansi-blue-fg">=</span>session<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 437</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> f<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwds<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    438</span>
<span class="ansi-green-intense-fg ansi-bold">    439</span>     <span class="ansi-green-fg">return</span> wrapper

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/rasterio/__init__.py</span> in <span class="ansi-cyan-fg">open</span><span class="ansi-blue-fg">(fp, mode, driver, width, height, count, crs, transform, dtype, nodata, sharing, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    228</span>             writer <span class="ansi-blue-fg">=</span> get_writer_for_driver<span class="ansi-blue-fg">(</span>driver<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    229</span>             <span class="ansi-green-fg">if</span> writer <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 230</span><span class="ansi-red-fg">                 s = writer(path, mode, driver=driver,
</span><span class="ansi-green-intense-fg ansi-bold">    231</span>                            width<span class="ansi-blue-fg">=</span>width<span class="ansi-blue-fg">,</span> height<span class="ansi-blue-fg">=</span>height<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    232</span>                            count<span class="ansi-blue-fg">=</span>count<span class="ansi-blue-fg">,</span> crs<span class="ansi-blue-fg">=</span>crs<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">rasterio/_io.pyx</span> in <span class="ansi-cyan-fg">rasterio._io.DatasetWriterBase.__init__</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">RasterioIOError</span>: median_composite.tif: Free disk space available is 7437549568 bytes, whereas 10046140128 are at least necessary. You can disable this check by defining the CHECK_DISK_FREE_SPACE configuration option to FALSE.
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[174]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>rgb_comp = color_composite(med_ds, &#39;B04&#39;, &#39;B03&#39;, &#39;B02&#39;, 5)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[175]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>rgb_comp.plot.imshow()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_359/387670261.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>rgb_comp<span class="ansi-blue-fg">.</span>plot<span class="ansi-blue-fg">.</span>imshow<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/plot/plot.py</span> in <span class="ansi-cyan-fg">plotmethod</span><span class="ansi-blue-fg">(_PlotMethods_obj, x, y, figsize, size, aspect, ax, row, col, col_wrap, xincrease, yincrease, add_colorbar, add_labels, vmin, vmax, cmap, colors, center, robust, extend, levels, infer_intervals, subplot_kws, cbar_ax, cbar_kwargs, xscale, yscale, xticks, yticks, xlim, ylim, norm, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1300</span>         <span class="ansi-green-fg">for</span> arg <span class="ansi-green-fg">in</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;_PlotMethods_obj&#34;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;newplotfunc&#34;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;kwargs&#34;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1301</span>             <span class="ansi-green-fg">del</span> allargs<span class="ansi-blue-fg">[</span>arg<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">-&gt; 1302</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> newplotfunc<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">**</span>allargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1303</span>
<span class="ansi-green-intense-fg ansi-bold">   1304</span>     <span class="ansi-red-fg"># Add to class _PlotMethods</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/plot/plot.py</span> in <span class="ansi-cyan-fg">newplotfunc</span><span class="ansi-blue-fg">(darray, x, y, figsize, size, aspect, ax, row, col, col_wrap, xincrease, yincrease, add_colorbar, add_labels, vmin, vmax, cmap, center, robust, extend, levels, infer_intervals, colors, subplot_kws, cbar_ax, cbar_kwargs, xscale, yscale, xticks, yticks, xlim, ylim, norm, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1164</span>
<span class="ansi-green-intense-fg ansi-bold">   1165</span>         <span class="ansi-red-fg"># Pass the data as a masked ndarray too</span>
<span class="ansi-green-fg">-&gt; 1166</span><span class="ansi-red-fg">         </span>zval <span class="ansi-blue-fg">=</span> darray<span class="ansi-blue-fg">.</span>to_masked_array<span class="ansi-blue-fg">(</span>copy<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1167</span>
<span class="ansi-green-intense-fg ansi-bold">   1168</span>         <span class="ansi-red-fg"># Replace pd.Intervals if contained in xval or yval.</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/dataarray.py</span> in <span class="ansi-cyan-fg">to_masked_array</span><span class="ansi-blue-fg">(self, copy)</span>
<span class="ansi-green-intense-fg ansi-bold">   2802</span>             Masked where invalid values <span class="ansi-blue-fg">(</span>nan <span class="ansi-green-fg">or</span> inf<span class="ansi-blue-fg">)</span> occur<span class="ansi-blue-fg">.</span>
<span class="ansi-green-intense-fg ansi-bold">   2803</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">-&gt; 2804</span><span class="ansi-red-fg">         </span>values <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>to_numpy<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>  <span class="ansi-red-fg"># only compute lazy arrays once</span>
<span class="ansi-green-intense-fg ansi-bold">   2805</span>         isnull <span class="ansi-blue-fg">=</span> pd<span class="ansi-blue-fg">.</span>isnull<span class="ansi-blue-fg">(</span>values<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2806</span>         <span class="ansi-green-fg">return</span> np<span class="ansi-blue-fg">.</span>ma<span class="ansi-blue-fg">.</span>MaskedArray<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">=</span>values<span class="ansi-blue-fg">,</span> mask<span class="ansi-blue-fg">=</span>isnull<span class="ansi-blue-fg">,</span> copy<span class="ansi-blue-fg">=</span>copy<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/dataarray.py</span> in <span class="ansi-cyan-fg">to_numpy</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    661</span>         DataArray<span class="ansi-blue-fg">.</span>data
<span class="ansi-green-intense-fg ansi-bold">    662</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 663</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>variable<span class="ansi-blue-fg">.</span>to_numpy<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    664</span>
<span class="ansi-green-intense-fg ansi-bold">    665</span>     <span class="ansi-green-fg">def</span> as_numpy<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">:</span> T_DataArray<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> T_DataArray<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/variable.py</span> in <span class="ansi-cyan-fg">to_numpy</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   1111</span>         <span class="ansi-red-fg"># TODO first attempt to call .to_numpy() once some libraries implement it</span>
<span class="ansi-green-intense-fg ansi-bold">   1112</span>         <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">,</span> dask_array_type<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1113</span><span class="ansi-red-fg">             </span>data <span class="ansi-blue-fg">=</span> data<span class="ansi-blue-fg">.</span>compute<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1114</span>         <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">,</span> cupy_array_type<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1115</span>             data <span class="ansi-blue-fg">=</span> data<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/dask/base.py</span> in <span class="ansi-cyan-fg">compute</span><span class="ansi-blue-fg">(self, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    286</span>         dask<span class="ansi-blue-fg">.</span>base<span class="ansi-blue-fg">.</span>compute
<span class="ansi-green-intense-fg ansi-bold">    287</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 288</span><span class="ansi-red-fg">         </span><span class="ansi-blue-fg">(</span>result<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">=</span> compute<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> traverse<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    289</span>         <span class="ansi-green-fg">return</span> result
<span class="ansi-green-intense-fg ansi-bold">    290</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/dask/base.py</span> in <span class="ansi-cyan-fg">compute</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    568</span>         postcomputes<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">.</span>__dask_postcompute__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    569</span>
<span class="ansi-green-fg">--&gt; 570</span><span class="ansi-red-fg">     </span>results <span class="ansi-blue-fg">=</span> schedule<span class="ansi-blue-fg">(</span>dsk<span class="ansi-blue-fg">,</span> keys<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    571</span>     <span class="ansi-green-fg">return</span> repack<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>f<span class="ansi-blue-fg">(</span>r<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>a<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> r<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span> a<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">in</span> zip<span class="ansi-blue-fg">(</span>results<span class="ansi-blue-fg">,</span> postcomputes<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    572</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/client.py</span> in <span class="ansi-cyan-fg">get</span><span class="ansi-blue-fg">(self, dsk, keys, workers, allow_other_workers, resources, sync, asynchronous, direct, retries, priority, fifo_timeout, actors, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2720</span>                     should_rejoin <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span>
<span class="ansi-green-intense-fg ansi-bold">   2721</span>             <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 2722</span><span class="ansi-red-fg">                 </span>results <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>gather<span class="ansi-blue-fg">(</span>packed<span class="ansi-blue-fg">,</span> asynchronous<span class="ansi-blue-fg">=</span>asynchronous<span class="ansi-blue-fg">,</span> direct<span class="ansi-blue-fg">=</span>direct<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2723</span>             <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   2724</span>                 <span class="ansi-green-fg">for</span> f <span class="ansi-green-fg">in</span> futures<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/client.py</span> in <span class="ansi-cyan-fg">gather</span><span class="ansi-blue-fg">(self, futures, errors, direct, asynchronous)</span>
<span class="ansi-green-intense-fg ansi-bold">   1975</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1976</span>                 local_worker <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-fg">-&gt; 1977</span><span class="ansi-red-fg">             return self.sync(
</span><span class="ansi-green-intense-fg ansi-bold">   1978</span>                 self<span class="ansi-blue-fg">.</span>_gather<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   1979</span>                 futures<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/client.py</span> in <span class="ansi-cyan-fg">sync</span><span class="ansi-blue-fg">(self, func, asynchronous, callback_timeout, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    863</span>             <span class="ansi-green-fg">return</span> future
<span class="ansi-green-intense-fg ansi-bold">    864</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 865</span><span class="ansi-red-fg">             return sync(
</span><span class="ansi-green-intense-fg ansi-bold">    866</span>                 self<span class="ansi-blue-fg">.</span>loop<span class="ansi-blue-fg">,</span> func<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> callback_timeout<span class="ansi-blue-fg">=</span>callback_timeout<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs
<span class="ansi-green-intense-fg ansi-bold">    867</span>             )

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/site-packages/distributed/utils.py</span> in <span class="ansi-cyan-fg">sync</span><span class="ansi-blue-fg">(loop, func, callback_timeout, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    322</span>     <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    323</span>         <span class="ansi-green-fg">while</span> <span class="ansi-green-fg">not</span> e<span class="ansi-blue-fg">.</span>is_set<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 324</span><span class="ansi-red-fg">             </span>e<span class="ansi-blue-fg">.</span>wait<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">10</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    325</span>     <span class="ansi-green-fg">if</span> error<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    326</span>         typ<span class="ansi-blue-fg">,</span> exc<span class="ansi-blue-fg">,</span> tb <span class="ansi-blue-fg">=</span> error<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/threading.py</span> in <span class="ansi-cyan-fg">wait</span><span class="ansi-blue-fg">(self, timeout)</span>
<span class="ansi-green-intense-fg ansi-bold">    572</span>             signaled <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_flag
<span class="ansi-green-intense-fg ansi-bold">    573</span>             <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> signaled<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 574</span><span class="ansi-red-fg">                 </span>signaled <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_cond<span class="ansi-blue-fg">.</span>wait<span class="ansi-blue-fg">(</span>timeout<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    575</span>             <span class="ansi-green-fg">return</span> signaled
<span class="ansi-green-intense-fg ansi-bold">    576</span>

<span class="ansi-green-fg">/srv/conda/envs/notebook/lib/python3.9/threading.py</span> in <span class="ansi-cyan-fg">wait</span><span class="ansi-blue-fg">(self, timeout)</span>
<span class="ansi-green-intense-fg ansi-bold">    314</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    315</span>                 <span class="ansi-green-fg">if</span> timeout <span class="ansi-blue-fg">&gt;</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 316</span><span class="ansi-red-fg">                     </span>gotit <span class="ansi-blue-fg">=</span> waiter<span class="ansi-blue-fg">.</span>acquire<span class="ansi-blue-fg">(</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span> timeout<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    317</span>                 <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    318</span>                     gotit <span class="ansi-blue-fg">=</span> waiter<span class="ansi-blue-fg">.</span>acquire<span class="ansi-blue-fg">(</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>:
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cluster.close()
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Hatfield Consultants
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">KNN Land Classification with Dask [40 hours]</a><ul>
<li><a class="reference internal" href="#K-Means-Land-Classification-with-Dask-(WIP!!)">K-Means Land Classification with Dask (WIP!!)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#1.-Initialize-Dask-Cluster">1. Initialize Dask Cluster</a></li>
<li><a class="reference internal" href="#Query-using-the-SentinelSat-API">Query using the SentinelSat API</a></li>
<li><a class="reference internal" href="#2.-Functions">2. Functions</a></li>
<li><a class="reference internal" href="#2.-Loading,-Masking,-and-Creating-Mosaics">2. Loading, Masking, and Creating Mosaics</a></li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/tabs.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>